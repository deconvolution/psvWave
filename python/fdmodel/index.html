<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>psvWave.fdModel &mdash; psvWave 74bfb8a901eff20e8c1eafefb967ba44dee5698d documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/add_class.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Configuration files" href="../configuration.html" />
    <link rel="prev" title="Python API reference" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> psvWave
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Homepage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../typical-workflow.html">Typical FWI workflow</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Python API reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">psvWave.fdModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html">Configuration files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp/index.html">C++ API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">psvWave</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Python API reference</a> &raquo;</li>
      <li>psvWave.fdModel</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/python/fdmodel/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="psvwave-fdmodel">
<h1>psvWave.fdModel<a class="headerlink" href="#psvwave-fdmodel" title="Permalink to this headline"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="psvWave.fdModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">psvWave.</span></span><span class="sig-name descname"><span class="pre">fdModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configuration_file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel" title="Permalink to this definition"></a></dt>
<dd><p>Class to simulate P-SV wave phyiscs and its adjoint state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>configuration_file_path</strong> – Path to the desired configuration.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.adjoint_simulate">
<span class="sig-name descname"><span class="pre">adjoint_simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_shot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omp_threads_override</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.adjoint_simulate" title="Permalink to this definition"></a></dt>
<dd><p>Adjoint simulate the wavefield for a given shot. This additionally correlates the adjoint wavefields for this shot with those stored in the snapshots to calculate the sensitivity kernel in Lamé’s parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i_shot</strong> (<em>int</em>) – Integer representing which shot will be simulated.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Boolean controlling the verbosity of the simulation.</p></li>
<li><p><strong>omp_threads_override</strong> (<em>int</em>) – Integer determining the amounts of threads that will be used. Defaults to the environment variable if not passed / 0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.calculate_l2_adjoint_sources">
<span class="sig-name descname"><span class="pre">calculate_l2_adjoint_sources</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.calculate_l2_adjoint_sources" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the adjoint sources corresponding to the L2 misfit w.r.t. the observed data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.calculate_l2_misfit">
<span class="sig-name descname"><span class="pre">calculate_l2_misfit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.calculate_l2_misfit" title="Permalink to this definition"></a></dt>
<dd><p>Calculate L2 misfit for simulated waveforms w.r.t. observed data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#psvWave.fdModel" title="psvWave.fdModel"><span class="pre">psvWave.fdModel</span></a></span></span><a class="headerlink" href="#psvWave.fdModel.copy" title="Permalink to this definition"></a></dt>
<dd><p>Returns a copy of the object, duplicating all members.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.dt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dt</span></span><a class="headerlink" href="#psvWave.fdModel.dt" title="Permalink to this definition"></a></dt>
<dd><p>Time discretization</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.dx">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dx</span></span><a class="headerlink" href="#psvWave.fdModel.dx" title="Permalink to this definition"></a></dt>
<dd><p>Horizontal discretization</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.dz">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dz</span></span><a class="headerlink" href="#psvWave.fdModel.dz" title="Permalink to this definition"></a></dt>
<dd><p>Vertical discretization</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.forward_simulate">
<span class="sig-name descname"><span class="pre">forward_simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_shot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_fields</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_wavefields</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omp_threads_override</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.forward_simulate" title="Permalink to this definition"></a></dt>
<dd><p>Run forward simulations for a given ‘shot’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i_shot</strong> (<em>int</em>) – Integer representing which shot will be simulated.</p></li>
<li><p><strong>store_fields</strong> (<em>int</em>) – Boolean controlling whether or not wavefields are stored, defaults to <cite>True</cite>.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Boolean controlling the verbosity of the simulation.</p></li>
<li><p><strong>output_wavefields</strong> (<em>boolean</em>) – Boolean controlling whether or not wavefields are written to disk.</p></li>
<li><p><strong>omp_threads_override</strong> (<em>int</em>) – Integer determining the amounts of threads that will be used. Defaults to the environment variable if not passed / 0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.free_parameters">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">free_parameters</span></span><a class="headerlink" href="#psvWave.fdModel.free_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Total free parameters in the model, vp, vs, rho combined.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.get_coordinates">
<span class="sig-name descname"><span class="pre">get_coordinates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.get_coordinates" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.get_extent">
<span class="sig-name descname"><span class="pre">get_extent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.get_extent" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.get_gradient_vector">
<span class="sig-name descname"><span class="pre">get_gradient_vector</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="headerlink" href="#psvWave.fdModel.get_gradient_vector" title="Permalink to this definition"></a></dt>
<dd><p>Returns the computed gradient vector. Should be retreived only after all the following functions are run:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#psvWave.fdModel.set_model_vector" title="psvWave.fdModel.set_model_vector"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_model_vector()</span></code></a>, to set a new model for which    to calculate the gradient.</p></li>
<li><p>For each shot, <a class="reference internal" href="#psvWave.fdModel.forward_simulate" title="psvWave.fdModel.forward_simulate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward_simulate()</span></code></a>, to simulate    the forward wavefields.</p></li>
<li><p><a class="reference internal" href="#psvWave.fdModel.calculate_l2_misfit" title="psvWave.fdModel.calculate_l2_misfit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calculate_l2_misfit()</span></code></a> to calculate the L2 misfit    of the synthetic waveforms w.r.t. the data.</p></li>
<li><p><a class="reference internal" href="#psvWave.fdModel.calculate_l2_adjoint_sources" title="psvWave.fdModel.calculate_l2_adjoint_sources"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calculate_l2_adjoint_sources()</span></code></a> to calculate the    adjoint sources corresponding to the current model.</p></li>
<li><p><a class="reference internal" href="#psvWave.fdModel.calculate_l2_adjoint_sources" title="psvWave.fdModel.calculate_l2_adjoint_sources"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calculate_l2_adjoint_sources()</span></code></a> to calculate the    adjoint sources corresponding to the current model.</p></li>
<li><p><a class="reference internal" href="#psvWave.fdModel.adjoint_simulate" title="psvWave.fdModel.adjoint_simulate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">adjoint_simulate()</span></code></a> to simulate the adjoint    (backward) wavefield.</p></li>
<li><p><a class="reference internal" href="#psvWave.fdModel.reset_kernels" title="psvWave.fdModel.reset_kernels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset_kernels()</span></code></a> to empty the current kernels.</p></li>
<li><p>For each shot <a class="reference internal" href="#psvWave.fdModel.adjoint_simulate" title="psvWave.fdModel.adjoint_simulate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">adjoint_simulate()</span></code></a> to simulate the    adjoint (backward) wavefield exactly once. Simulating one of the shots    twice will result in incorrect kernels.</p></li>
<li><p><a class="reference internal" href="#psvWave.fdModel.map_kernels_to_velocity" title="psvWave.fdModel.map_kernels_to_velocity"><code class="xref py py-meth docutils literal notranslate"><span class="pre">map_kernels_to_velocity()</span></code></a> to map the    sensitivities in Lamé’s parameters (lambda, mu, rho) to velocity (vp,    vs, rho).</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Current gradient vector.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.get_kernels">
<span class="sig-name descname"><span class="pre">get_kernels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.get_kernels" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.get_model_vector">
<span class="sig-name descname"><span class="pre">get_model_vector</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="headerlink" href="#psvWave.fdModel.get_model_vector" title="Permalink to this definition"></a></dt>
<dd><p>Get the current model in the model as a numpy vector, flattened.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Current model vector containing P-wave speed, S-wave speed, and density.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.get_observed_data">
<span class="sig-name descname"><span class="pre">get_observed_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.get_observed_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.get_parameter_fields">
<span class="sig-name descname"><span class="pre">get_parameter_fields</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.get_parameter_fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.get_receivers">
<span class="sig-name descname"><span class="pre">get_receivers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_absorbing_boundary_as_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#psvWave.fdModel.get_receivers" title="Permalink to this definition"></a></dt>
<dd><p>Get the receiver array coordinates either in meters or grid indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_units</strong> (<em>bool</em>) – Boolean controlling if the returned coordinates are physical distance from origin or grid indices.</p></li>
<li><p><strong>include_absorbing_boundary_as_index</strong> (<em>bool</em>) – Boolean controlling whether or not to place the origin at the edge of the absording boundary or within it.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of 2 numpy.ndarray’s for horizontal and vertical coordinate, each of shape (n_receivers, 1).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[numpy.ndarray, numpy,ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.get_snapshots">
<span class="sig-name descname"><span class="pre">get_snapshots</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#psvWave.fdModel.get_snapshots" title="Permalink to this definition"></a></dt>
<dd><p>Get snapshots of all the dynamical fields generated across all the shots.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.get_sources">
<span class="sig-name descname"><span class="pre">get_sources</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.get_sources" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.get_synthetic_data">
<span class="sig-name descname"><span class="pre">get_synthetic_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.get_synthetic_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.load_vector">
<span class="sig-name descname"><span class="pre">load_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relative_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="headerlink" href="#psvWave.fdModel.load_vector" title="Permalink to this definition"></a></dt>
<dd><p>Loads a vector of shape (free_parameters, 1) from a text file. Read in precision <cite>real_simulation</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.map_kernels_to_velocity">
<span class="sig-name descname"><span class="pre">map_kernels_to_velocity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.map_kernels_to_velocity" title="Permalink to this definition"></a></dt>
<dd><p>Transform sensitivity kernels in Lamé parametrization (lambda, mu, rho) to velocity parametrization (vp, vs, rho).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.misfit">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">misfit</span></span><a class="headerlink" href="#psvWave.fdModel.misfit" title="Permalink to this definition"></a></dt>
<dd><p>Current misfit in the model.</p>
<p>This value is updated after <a class="reference internal" href="#psvWave.fdModel.calculate_l2_misfit" title="psvWave.fdModel.calculate_l2_misfit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calculate_l2_misfit()</span></code></a> is run.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.n_shots">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_shots</span></span><a class="headerlink" href="#psvWave.fdModel.n_shots" title="Permalink to this definition"></a></dt>
<dd><p>Number of shots</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.n_sources">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_sources</span></span><a class="headerlink" href="#psvWave.fdModel.n_sources" title="Permalink to this definition"></a></dt>
<dd><p>Number of sources across shots. Does not indicate how many per shot.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.np_boundary">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">np_boundary</span></span><a class="headerlink" href="#psvWave.fdModel.np_boundary" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.nt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nt</span></span><a class="headerlink" href="#psvWave.fdModel.nt" title="Permalink to this definition"></a></dt>
<dd><p>Total time points</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.nx">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nx</span></span><a class="headerlink" href="#psvWave.fdModel.nx" title="Permalink to this definition"></a></dt>
<dd><p>Total horizontal points, including boundary layer</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.nx_free_parameters">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nx_free_parameters</span></span><a class="headerlink" href="#psvWave.fdModel.nx_free_parameters" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.nx_inner">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nx_inner</span></span><a class="headerlink" href="#psvWave.fdModel.nx_inner" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.nx_inner_boundary">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nx_inner_boundary</span></span><a class="headerlink" href="#psvWave.fdModel.nx_inner_boundary" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.nz">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nz</span></span><a class="headerlink" href="#psvWave.fdModel.nz" title="Permalink to this definition"></a></dt>
<dd><p>Total vertical points, including boundary layer</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.nz_free_parameters">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nz_free_parameters</span></span><a class="headerlink" href="#psvWave.fdModel.nz_free_parameters" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.nz_inner">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nz_inner</span></span><a class="headerlink" href="#psvWave.fdModel.nz_inner" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.nz_inner_boundary">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nz_inner_boundary</span></span><a class="headerlink" href="#psvWave.fdModel.nz_inner_boundary" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psvWave.fdModel.parameters">
<span class="sig-name descname"><span class="pre">parameters</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['$v_p$',</span> <span class="pre">'$v_s$',</span> <span class="pre">'$\\rho$']</span></em><a class="headerlink" href="#psvWave.fdModel.parameters" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.plot_data">
<span class="sig-name descname"><span class="pre">plot_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exagerration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.plot_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.plot_domain">
<span class="sig-name descname"><span class="pre">plot_domain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shot_to_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.plot_domain" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.plot_fields">
<span class="sig-name descname"><span class="pre">plot_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">fields=None,</span> <span class="pre">axes=None,</span> <span class="pre">shot_to_plot=None,</span> <span class="pre">cmap=&lt;matplotlib.colors.LinearSegmentedColormap</span> <span class="pre">object&gt;,</span> <span class="pre">vmin=[None,</span> <span class="pre">None,</span> <span class="pre">None],</span> <span class="pre">vmax=[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.plot_fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.plot_model_vector">
<span class="sig-name descname"><span class="pre">plot_model_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">m,</span> <span class="pre">axes=None,</span> <span class="pre">shot_to_plot=None,</span> <span class="pre">cmap=&lt;matplotlib.colors.LinearSegmentedColormap</span> <span class="pre">object&gt;,</span> <span class="pre">vmin=[None,</span> <span class="pre">None,</span> <span class="pre">None],</span> <span class="pre">vmax=[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.plot_model_vector" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.plot_observed_data">
<span class="sig-name descname"><span class="pre">plot_observed_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exagerration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.plot_observed_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.plot_synthetic_data">
<span class="sig-name descname"><span class="pre">plot_synthetic_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exagerration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.plot_synthetic_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.reset_kernels">
<span class="sig-name descname"><span class="pre">reset_kernels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.reset_kernels" title="Permalink to this definition"></a></dt>
<dd><p>Reset kernel accumulators to zero. Important for adjoint simulations, as they simply keep accumulating wavefield correlations across shots and iterations otherwise. Making this manual allows for flexibility (e.g. different misfit per shot).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.set_model_vector">
<span class="sig-name descname"><span class="pre">set_model_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.set_model_vector" title="Permalink to this definition"></a></dt>
<dd><p>Update the model (vp, vs, rho) in the class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>m</strong> (<em>numpy.ndarray</em>) – vector of shape (free_parameters, 1).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.set_observed_data">
<span class="sig-name descname"><span class="pre">set_observed_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.set_observed_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.set_parameter_fields">
<span class="sig-name descname"><span class="pre">set_parameter_fields</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.set_parameter_fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psvWave.fdModel.set_synthetic_data">
<span class="sig-name descname"><span class="pre">set_synthetic_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#psvWave.fdModel.set_synthetic_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.snapshot_interval">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">snapshot_interval</span></span><a class="headerlink" href="#psvWave.fdModel.snapshot_interval" title="Permalink to this definition"></a></dt>
<dd><p>The interval of timesteps between snapshots.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.snapshots">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">snapshots</span></span><a class="headerlink" href="#psvWave.fdModel.snapshots" title="Permalink to this definition"></a></dt>
<dd><p>The total amount of snapshots per shot.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psvWave.fdModel.units">
<span class="sig-name descname"><span class="pre">units</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['$m/s$',</span> <span class="pre">'$m/s$',</span> <span class="pre">'$kg/m^3$']</span></em><a class="headerlink" href="#psvWave.fdModel.units" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psvWave.fdModel.which_source_to_fire_in_which_shot">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">which_source_to_fire_in_which_shot</span></span><a class="headerlink" href="#psvWave.fdModel.which_source_to_fire_in_which_shot" title="Permalink to this definition"></a></dt>
<dd><p>Which source fires in which shot.</p>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="Python API reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../configuration.html" class="btn btn-neutral float-right" title="Configuration files" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2022, Lars Gebraad.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>